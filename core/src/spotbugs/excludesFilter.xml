<?xml version="1.0"?>
<FindBugsFilter>
  <!--
    Exclusions in this section have been triaged and determined to be false positives.
  -->
  <Match>
    <Or>
      <!-- We don't care about this behavior -->
      <Bug pattern="CRLF_INJECTION_LOGS"/>
      <!-- Pending https://github.com/spotbugs/spotbugs/issues/1515 -->
      <Bug pattern="DP_CREATE_CLASSLOADER_INSIDE_DO_PRIVILEGED"/>
      <!-- Silly check; it is perfectly reasonable to implement Comparable by writing a compareTo without an equals. -->
      <Bug pattern="EQ_COMPARETO_USE_OBJECT_EQUALS"/>
      <!-- Jenkins handles this issue differently or doesn't care about it -->
      <Bug pattern="INFORMATION_EXPOSURE_THROUGH_AN_ERROR_MESSAGE"/>
      <!-- Used for backward compatibility and extending utility classes -->
      <Bug pattern="NM_SAME_SIMPLE_NAME_AS_SUPERCLASS"/>
    </Or>
  </Match>
  <Match>
    <!-- Ignore autogenerated methods -->
    <Bug pattern="DM_NUMBER_CTOR"/>
    <Class name="hudson.scheduler.CrontabLexer"/>
  </Match>
  <Match>
    <!-- Ignore autogenerated methods -->
    <Bug pattern="MS_FINAL_PKGPROTECT"/>
    <Or>
      <Class name="hudson.model.labels.LabelExpressionLexer"/>
      <Class name="hudson.scheduler.CrontabLexer"/>
    </Or>
  </Match>
  <Match>
    <!-- Ignore autogenerated methods -->
    <Bug pattern="MS_PKGPROTECT"/>
    <Or>
      <Class name="hudson.model.labels.LabelExpressionLexer"/>
      <Class name="hudson.model.labels.LabelExpressionParser"/>
      <Class name="hudson.scheduler.CrontabLexer"/>
      <Class name="hudson.scheduler.CrontabParser"/>
    </Or>
  </Match>
  <Match>
    <!-- Ignore autogenerated methods -->
    <Bug pattern="NM_METHOD_NAMING_CONVENTION"/>
    <Or>
      <Class name="hudson.tasks.Messages"/>
      <Class name="hudson.tools.Messages"/>
    </Or>
  </Match>
  <Match>
    <!-- Ignore autogenerated methods -->
    <Bug pattern="SF_SWITCH_NO_DEFAULT"/>
    <Class name="hudson.scheduler.CrontabParser"/>
  </Match>
  <Match>
    <!-- Preserve API compatibility -->
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.PluginManager"/>
    <Field name="pluginUploaded"/>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.ProxyConfiguration"/>
    <Field name="noProxyHost"/>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.cli.CLICommand"/>
    <Or>
      <Field name="locale"/>
      <Field name="stderr"/>
      <Field name="stdin"/>
      <Field name="stdout"/>
    </Or>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.cli.CopyJobCommand"/>
    <Field name="dst"/>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.cli.CreateJobCommand"/>
    <Field name="name"/>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.cli.SetBuildDescriptionCommand"/>
    <Field name="description"/>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.cli.SetBuildDisplayNameCommand"/>
    <Field name="displayName"/>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.model.Job"/>
    <Field name="runIdMigrator"/>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.model.StringParameterValue"/>
    <Field name="value"/>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.security.Permission"/>
    <Field name="enabled"/>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.tasks.Maven"/>
    <Field name="usePrivateRepository"/>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.util.Graph"/>
    <Field name="defaultScale"/>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.widgets.HistoryWidget"/>
    <Field name="baseList"/>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="jenkins.model.Jenkins"/>
    <Or>
      <Field name="tcpSlaveAgentListener"/>
      <Field name="proxy"/>
      <Field name="VERSION"/>
      <Field name="CHANGELOG_URL"/>
      <Field name="VERSION_HASH"/>
      <Field name="SESSION_HASH"/>
      <Field name="RESOURCE_PATH"/>
      <Field name="VIEW_RESOURCE_PATH"/>
    </Or>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="jenkins.widgets.HistoryPageFilter"/>
    <Or>
      <Field name="hasDownPage"/>
      <Field name="hasUpPage"/>
      <Field name="newestOnPage"/>
      <Field name="nextBuildNumber"/>
      <Field name="oldestOnPage"/>
    </Or>
  </Match>
  <Match>
    <Bug pattern="PA_PUBLIC_PRIMITIVE_ATTRIBUTE"/>
    <Class name="hudson.slaves.JNLPLauncher"/>
    <Field name="tunnel"/>
  </Match>
  <Match>
    <!-- Reserved for future use -->
    <Bug pattern="SS_SHOULD_BE_STATIC"/>
    <Class name="hudson.model.User"/>
    <Field name="version"/>
  </Match>
  <Match>
    <!-- Reserved for future use -->
    <Bug pattern="SS_SHOULD_BE_STATIC"/>
    <Class name="hudson.model.UserIdMapper"/>
    <Field name="version"/>
  </Match>
  <Match>
    <!-- Reserved for future use -->
    <Bug pattern="SS_SHOULD_BE_STATIC"/>
    <Class name="hudson.util.Graph"/>
    <Field name="defaultScale"/>
  </Match>
  <!--
    Here lies technical debt. Exclusions in this section have not yet been triaged. When working on
    on this section, pick an exclusion to triage, then:
    - If it is a false positive, add a @SuppressFBWarnings(value = "[…]", justification = "[…]")
      annotation indicating the reason why it is a false positive, then remove the exclusion from
      this section.
    - If it is not a false positive, fix the bug, then remove the exclusion from this section.
   -->
  <Match>
    <And>
      <Bug pattern="DM_DEFAULT_ENCODING"/>
      <Or>
        <Class name="hudson.console.ConsoleNote"/>
        <Class name="hudson.lifecycle.WindowsServiceLifecycle"/>
        <Class name="hudson.util.TextFile"/>
      </Or>
    </And>
  </Match>
  <Match>
    <Confidence value="2"/>
    <Or>
      <And>
        <Bug pattern="COMMAND_INJECTION"/>
        <Or>
          <Class name="hudson.Launcher$LocalLauncher"/>
          <Class name="hudson.Launcher$RemoteChannelLaunchCallable"/>
          <Class name="hudson.os.WindowsUtil"/>
          <Class name="jenkins.slaves.restarter.WinswSlaveRestarter"/>
        </Or>
      </And>
      <And>
        <Bug pattern="EC_UNRELATED_TYPES_USING_POINTER_EQUALITY"/>
        <Or>
          <Class name="hudson.model.AutoCompletionCandidates"/>
          <Class name="hudson.tasks.Fingerprinter$FingerprintAction"/>
        </Or>
      </And>
      <And>
        <Bug pattern="EQ_DOESNT_OVERRIDE_EQUALS"/>
        <Or>
          <Class name="hudson.model.Run$ArtifactList"/>
          <Class name="hudson.model.Run$SerializableArtifactList"/>
          <Class name="hudson.search.Search$SearchResultImpl"/>
          <Class name="hudson.slaves.NodeList"/>
        </Or>
      </And>
      <And>
        <Bug pattern="FILE_UPLOAD_FILENAME"/>
        <Or>
          <Class name="hudson.model.FileParameterDefinition"/>
          <Class name="hudson.model.FileParameterValue"/>
          <Class name="hudson.PluginManager"/>
        </Or>
      </And>
      <And>
        <Bug pattern="HTTP_PARAMETER_POLLUTION"/>
        <Class name="hudson.ProxyConfiguration$DescriptorImpl"/>
      </And>
      <And>
        <Bug pattern="HTTP_RESPONSE_SPLITTING"/>
        <Or>
          <Class name="hudson.Functions"/>
          <Class name="jenkins.install.InstallUtil"/>
          <Class name="jenkins.model.Jenkins"/>
          <Class name="jenkins.util.xml.XMLUtils"/>
        </Or>
      </And>
      <And>
        <Bug pattern="LI_LAZY_INIT_STATIC"/>
        <Class name="hudson.triggers.Trigger"/>
      </And>
      <And>
        <Bug pattern="NP_NULL_ON_SOME_PATH_FROM_RETURN_VALUE"/>
        <Or>
          <Class name="hudson.cli.BuildCommand"/>
          <Class name="hudson.cli.DeleteNodeCommand"/>
          <Class name="hudson.cli.UpdateNodeCommand"/>
          <Class name="hudson.cli.WaitNodeOfflineCommand"/>
          <Class name="hudson.cli.WaitNodeOnlineCommand"/>
          <Class name="hudson.FilePath$IsDescendant"/>
          <Class name="hudson.FilePath$MoveAllChildrenTo"/>
          <Class name="hudson.Launcher$RemoteLauncher"/>
          <Class name="hudson.model.AbstractBuild$AbstractBuildExecution"/>
          <Class name="hudson.model.AbstractProject"/>
          <Class name="hudson.model.Build$BuildExecution"/>
          <Class name="hudson.model.Cause$UserIdCause"/>
          <Class name="hudson.model.Computer"/>
          <Class name="hudson.model.Descriptor$HelpRedirect"/>
          <Class name="hudson.model.Descriptor$NewInstanceBindInterceptor"/>
          <Class name="hudson.model.ItemGroupMixIn"/>
          <Class name="hudson.model.Job"/>
          <Class name="hudson.model.Queue"/>
          <Class name="hudson.model.Queue$JobOffer"/>
          <Class name="hudson.model.queue.CauseOfBlockage$BecauseNodeIsBusy"/>
          <Class name="hudson.model.queue.CauseOfBlockage$BecauseNodeIsOffline"/>
          <Class name="hudson.model.queue.MappingWorksheet$ExecutorChunk"/>
          <Class name="hudson.model.queue.WorkUnitContext"/>
          <Class name="hudson.model.ResultTrend"/>
          <Class name="hudson.model.Run"/>
          <Class name="hudson.model.RunParameterValue"/>
          <Class name="hudson.model.Slave"/>
          <Class name="hudson.model.TopLevelItemDescriptor"/>
          <Class name="hudson.model.UpdateCenter$HudsonDowngradeJob"/>
          <Class name="hudson.model.UpdateCenter$HudsonUpgradeJob"/>
          <Class name="hudson.model.UpdateSite$Plugin"/>
          <Class name="hudson.model.UpdateSite$Warning"/>
          <Class name="hudson.model.User"/>
          <Class name="hudson.model.WorkspaceCleanupThread"/>
          <Class name="hudson.PluginManager"/>
          <Class name="hudson.PluginWrapper"/>
          <Class name="hudson.scm.SCM"/>
          <Class name="hudson.security.AuthorizationStrategy"/>
          <Class name="hudson.tasks.BuildTrigger"/>
          <Class name="hudson.tasks.Maven"/>
          <Class name="hudson.tasks.Maven$MavenInstallation"/>
          <Class name="hudson.TcpSlaveAgentListener$TcpSlaveAgentListenerRescheduler"/>
          <Class name="hudson.tools.DownloadFromUrlInstaller$DescriptorImpl"/>
          <Class name="hudson.tools.ToolInstallation"/>
          <Class name="hudson.triggers.SCMTrigger$DescriptorImpl"/>
          <Class name="hudson.util.AtomicFileWriter"/>
          <Class name="hudson.util.DirScanner$Full"/>
          <Class name="hudson.util.KeyedDataStorage"/>
          <Class name="hudson.util.PluginServletFilter"/>
          <Class name="jenkins.fingerprints.FileFingerprintStorage"/>
          <Class name="jenkins.fingerprints.FingerprintStorage"/>
          <Class name="jenkins.install.SetupWizard"/>
          <Class name="jenkins.model.Jenkins"/>
          <Class name="jenkins.model.Nodes"/>
          <Class name="jenkins.model.RunIdMigrator"/>
          <Class name="jenkins.mvn.SettingsPathHelper"/>
          <Class name="jenkins.security.CustomClassFilter$Contributed"/>
          <Class name="jenkins.security.ResourceDomainConfiguration"/>
          <Class name="jenkins.slaves.DefaultJnlpSlaveReceiver"/>
          <Class name="jenkins.util.VirtualFile$FilePathVF"/>
          <Class name="jenkins.util.VirtualFile$FileVF"/>
        </Or>
      </And>
      <And>
        <Bug pattern="PATH_TRAVERSAL_IN"/>
        <Or>
          <Class name="hudson.ClassicPluginStrategy"/>
          <Class name="hudson.cli.InstallPluginCommand"/>
          <Class name="hudson.EnvVars"/>
          <Class name="hudson.FilePath"/>
          <Class name="hudson.FilePath$CopyRecursiveLocal"/>
          <Class name="hudson.FilePath$CopyToWithPermission"/>
          <Class name="hudson.FilePath$CreateTempDir"/>
          <Class name="hudson.FilePath$CreateTempFile"/>
          <Class name="hudson.FilePath$CreateTextTempFile"/>
          <Class name="hudson.FilePath$ExplicitlySpecifiedDirScanner"/>
          <Class name="hudson.FilePath$FileCallableWrapper"/>
          <Class name="hudson.FilePath$IsDescendant"/>
          <Class name="hudson.FilePath$ListGlob"/>
          <Class name="hudson.FilePath$MoveAllChildrenTo"/>
          <Class name="hudson.FilePath$RenameTo"/>
          <Class name="hudson.FilePath$SymlinkTo"/>
          <Class name="hudson.FilePath$UnzipLocal"/>
          <Class name="hudson.init.InitStrategy"/>
          <Class name="hudson.Launcher$LocalLauncher"/>
          <Class name="hudson.Launcher$ProcStarter"/>
          <Class name="hudson.Launcher$RemoteChannelLaunchCallable"/>
          <Class name="hudson.Launcher$RemoteLaunchCallable"/>
          <Class name="hudson.lifecycle.Lifecycle"/>
          <Class name="hudson.lifecycle.WindowsServiceLifecycle"/>
          <Class name="hudson.LocalPluginManager"/>
          <Class name="hudson.logging.LogRecorder"/>
          <Class name="hudson.model.AsyncAperiodicWork"/>
          <Class name="hudson.model.AsyncPeriodicWork"/>
          <Class name="hudson.model.Computer"/>
          <Class name="hudson.model.Descriptor"/>
          <Class name="hudson.model.DirectoryBrowserSupport$IsAbsolute"/>
          <Class name="hudson.model.DownloadService$Downloadable"/>
          <Class name="hudson.model.FileParameterValue"/>
          <Class name="hudson.model.JDK"/>
          <Class name="hudson.model.Job$SubItemBuildsLocationImpl"/>
          <Class name="hudson.model.labels.LabelAtom"/>
          <Class name="hudson.model.Queue"/>
          <Class name="hudson.model.Run"/>
          <Class name="hudson.model.Run$Artifact"/>
          <Class name="hudson.model.UpdateCenter"/>
          <Class name="hudson.model.UpdateCenter$DownloadJob"/>
          <Class name="hudson.model.UpdateCenter$HudsonDowngradeJob"/>
          <Class name="hudson.model.UpdateCenter$InstallationJob"/>
          <Class name="hudson.model.UpdateCenter$PluginDowngradeJob"/>
          <Class name="hudson.model.UpdateCenter$UpdateCenterConfiguration"/>
          <Class name="hudson.model.UpdateSite"/>
          <Class name="hudson.model.UserIdMapper"/>
          <Class name="hudson.Plugin"/>
          <Class name="hudson.PluginManager"/>
          <Class name="hudson.PluginWrapper"/>
          <Class name="hudson.slaves.SlaveComputer$AbsolutePath"/>
          <Class name="hudson.tasks.Fingerprinter$FindRecords"/>
          <Class name="hudson.tasks.Maven$DecideDefaultMavenCommand"/>
          <Class name="hudson.tasks.Maven$MavenInstallation"/>
          <Class name="hudson.tasks.Maven$MavenInstallation$GetMavenVersion"/>
          <Class name="hudson.tools.ToolInstallation"/>
          <Class name="hudson.triggers.SafeTimerTask"/>
          <Class name="hudson.Util"/>
          <Class name="hudson.util.AtomicFileWriter"/>
          <Class name="hudson.util.CompressedFile"/>
          <Class name="hudson.util.DirScanner$Glob"/>
          <Class name="hudson.util.io.ReopenableRotatingFileOutputStream"/>
          <Class name="hudson.util.io.RewindableRotatingFileOutputStream"/>
          <Class name="hudson.util.IOUtils"/>
          <Class name="hudson.util.jna.Kernel32Utils"/>
          <Class name="hudson.util.ProcessTree$UnixProcess"/>
          <Class name="hudson.WebAppMain"/>
          <Class name="jenkins.diagnosis.HsErrPidList"/>
          <Class name="jenkins.fingerprints.FileFingerprintStorage"/>
          <Class name="jenkins.install.SetupWizard"/>
          <Class name="jenkins.model.Jenkins"/>
          <Class name="jenkins.model.Nodes"/>
          <Class name="jenkins.model.PeepholePermalink"/>
          <Class name="jenkins.model.RunIdMigrator"/>
          <Class name="jenkins.mvn.FilePathGlobalSettingsProvider"/>
          <Class name="jenkins.mvn.FilePathSettingsProvider"/>
          <Class name="jenkins.mvn.SettingsPathHelper"/>
          <Class name="jenkins.plugins.DetachedPluginsUtil$DetachedPlugin"/>
          <Class name="jenkins.security.ClassFilterImpl"/>
          <Class name="jenkins.security.ConfidentialKey"/>
          <Class name="jenkins.security.DefaultConfidentialStore"/>
          <Class name="jenkins.security.s2m.ConfigDirectory"/>
          <Class name="jenkins.security.stapler.StaplerDispatchValidator$ValidatorCache"/>
          <Class name="jenkins.security.stapler.StaticRoutingDecisionProvider"/>
          <Class name="jenkins.slaves.restarter.UnixSlaveRestarter"/>
          <Class name="jenkins.SoloFilePathFilter"/>
          <Class name="jenkins.util.groovy.GroovyHookScript"/>
          <Class name="jenkins.util.io.FileBoolean"/>
          <Class name="jenkins.util.JavaVMArguments"/>
          <Class name="jenkins.util.SystemProperties"/>
          <Class name="jenkins.util.VirtualFile$FilePathVF"/>
          <Class name="jenkins.util.VirtualFile$FileVF"/>
        </Or>
      </And>
      <And>
        <Bug pattern="REDOS"/>
        <Or>
          <Class name="hudson.model.Computer"/>
          <Class name="jenkins.org.apache.commons.validator.routines.UrlValidator"/>
        </Or>
      </And>
      <And>
        <Bug pattern="REQUESTDISPATCHER_FILE_DISCLOSURE"/>
        <Or>
          <Class name="hudson.cli.CLIAction"/>
          <Class name="hudson.model.AbstractProject"/>
          <Class name="hudson.model.Descriptor"/>
          <Class name="hudson.model.DirectoryBrowserSupport"/>
          <Class name="hudson.model.RSS"/>
          <Class name="hudson.model.Run"/>
          <Class name="hudson.scm.AbstractScmTagAction"/>
          <Class name="hudson.search.Search"/>
          <Class name="hudson.security.BasicAuthenticationFilter"/>
          <Class name="hudson.security.FederatedLoginService$UnclaimedIdentityException"/>
          <Class name="hudson.security.HudsonPrivateSecurityRealm"/>
          <Class name="hudson.slaves.NodeDescriptor"/>
          <Class name="hudson.slaves.SlaveComputer"/>
          <Class name="hudson.util.DoubleLaunchChecker"/>
          <Class name="hudson.util.ErrorObject"/>
          <Class name="hudson.util.HudsonIsLoading"/>
          <Class name="hudson.util.HudsonIsRestarting"/>
          <Class name="hudson.widgets.HistoryWidget"/>
          <Class name="jenkins.agents.CloudSet"/>
          <Class name="jenkins.management.AdministrativeMonitorsApi"/>
          <Class name="jenkins.model.Jenkins"/>
          <Class name="jenkins.model.ParameterizedJobMixIn"/>
          <Class name="jenkins.slaves.EncryptedSlaveAgentJnlpFile"/>
        </Or>
      </And>
      <And>
        <Bug pattern="SE_BAD_FIELD"/>
        <Class name="hudson.scm.PollingResult"/>
      </And>
      <And>
        <Bug pattern="STATIC_IV"/>
        <Or>
          <Class name="hudson.cli.Connection"/>
          <Class name="hudson.model.UsageStatistics$CombinedCipherOutputStream"/>
          <Class name="jenkins.security.CryptoConfidentialKey"/>
        </Or>
      </And>
      <And>
        <Bug pattern="UNENCRYPTED_SERVER_SOCKET"/>
        <Class name="hudson.slaves.Channels"/>
      </And>
      <And>
        <Bug pattern="UNENCRYPTED_SOCKET"/>
        <Class name="hudson.TcpSlaveAgentListener"/>
      </And>
      <And>
        <Bug pattern="URLCONNECTION_SSRF_FD"/>
        <Or>
          <Class name="hudson.FilePath"/>
          <Class name="hudson.FilePath$Unpack"/>
          <Class name="hudson.Main"/>
          <Class name="hudson.model.Descriptor"/>
          <Class name="hudson.model.Slave$JnlpJar"/>
          <Class name="hudson.PluginManager"/>
          <Class name="hudson.PluginWrapper"/>
          <Class name="hudson.ProxyConfiguration"/>
          <Class name="jenkins.security.ResourceDomainConfiguration"/>
        </Or>
      </And>
      <And>
        <Bug pattern="UR_UNINIT_READ_CALLED_FROM_SUPER_CONSTRUCTOR"/>
        <Class name="hudson.slaves.SlaveComputer"/>
      </And>
      <And>
        <Bug pattern="XSS_SERVLET"/>
        <Or>
          <Class name="hudson.Functions"/>
          <Class name="hudson.security.AccessDeniedException3"/>
        </Or>
      </And>
    </Or>
  </Match>
  <Match>
    <Bug pattern="SIC_INNER_SHOULD_BE_STATIC"/>
    <Class name="jenkins.security.stapler.StaplerDispatchValidator$ValidatorCache$Validator"/>
  </Match>
</FindBugsFilter>
